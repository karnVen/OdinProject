<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

     <style>
    #board {
  display: grid;
  grid-template-columns: repeat(3, 50px);
}
.cell {
  border: 1px solid #000;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
}
  </style>
</head>
<body>

  <div id="board"></div>
  <div id="status"></div>
    <script>
   
   const gameboard =function(){
    const board=["","","","","","","","",""];

   function markcell(position,marker){
    if(position>=0 && position<9 && board[position]===""){
        board[position]=marker;
        return true;

    }
    return false;

   }

   function getboard(){
    return [...board];

   }
   function resetboard(){
    board.fill("");
   }
   return {markcell,getboard,resetboard};

   }();

  function createPlayer(name,marker){
    return {name,marker};
  }
  



  const controller = function(){
    const player1 = createPlayer("karn", "X");
  const player2 = createPlayer("arjun", "O");
  let currentplayer=player1;

    function playturn(position){
        if (gameboard.markcell(position,currentplayer.marker)){
            const winner = checkwinner();
            if(winner) return winner;
             switchplayer();
        }
        return null;
    }

    function switchplayer(){
        currentplayer = currentplayer === player1 ? player2 : player1;
    }


function checkwinner(){

    const b = gameboard.getboard();
    const winPatterns = [
    [0,1,2], [3,4,5], [6,7,8], // Rows
    [0,3,6], [1,4,7], [2,5,8], // Columns
    [0,4,8], [2,4,6]            // Diagonals
  ];

  
                for (const [pos1, pos2, pos3] of winPatterns) {
                    if (b[pos1] && b[pos1] === b[pos2] && b[pos2] === b[pos3]) {
                        return b[pos1] === "X" ? player1 : player2;
                    }
                }

    /*for (let i = 0; i < winPatterns.length; i++) {
  const pattern = winPatterns[i];
  const pos1 = pattern[0];
  const pos2 = pattern[1];
  const pos3 = pattern[2];
  
  if (b[pos1] !== "" && b[pos1] === b[pos2] && b[pos2] === b[pos3]) {
    return b[pos1] === "X" ? player1 : player2;
  }
}
*/
 if (!b.includes("")) return "draw"; 
  
return null;
}

return {playturn,checkwinner,getCurrentPlayer:()=> currentplayer};



  }();

  /*
// Test 1: Player 1 wins top row (unchanged)
gameboard.resetboard();
console.log("Test 1 - Player 1 wins:");
console.log(controller.playturn(0)); // X
console.log(controller.playturn(3)); // O
console.log(controller.playturn(1)); // X
console.log(controller.playturn(4)); // O
console.log(controller.playturn(8)); // X wins (returns player1)
console.log(controller.playturn(5)); // X wins (returns player1)

// Test 2: Fixed draw scenario
gameboard.resetboard();
console.log("\nTest 2 - Draw:");
const drawMoves = [0,1,2,4,3,5,7,6,8]; // Forces draw
drawMoves.forEach(pos => {
    console.log(controller.playturn(pos));
});
console.log("Final result:", controller.checkwinner()); // Now returns "draw"

*/

const domLogic = {
  boardElement: document.getElementById('board'),
  statusElement: document.getElementById('status'),

  renderBoard(){
    const board = gameboard.getboard();
    this.boardElement.innerHTML= '';

    board.forEach((cell, index)=>{
      const cellElement = document.createElement('div');
      cellElement.className ='cell';
      cellElement.textContent = cell ;
      cellElement.dataset.index = index;
      this.boardElement.appendChild(cellElement);
    });
  },

  updateStatus(message){
    this.statusElement.textContent = message;
  }
 

};
domLogic.boardElement.addEventListener('click', (e) => {
  if (!e.target.classList.contains('cell')) return;
  
  const position = parseInt(e.target.dataset.index);
  const result = controller.playturn(position);
  domLogic.renderBoard();
  if (result) {
    if (result === "draw") domLogic.updateStatus("Game ended in a draw!");
    else domLogic.updateStatus(`${result.name} (${result.marker}) wins!`);
  } else {
    domLogic.updateStatus(`Current player: ${controller.currentplayer.name}`);
  }
  
  domLogic.renderBoard();
});
// Initialize game
gameboard.resetboard();
domLogic.renderBoard();
domLogic.updateStatus(`Current player: ${controller.getCurrentPlayer().name}`);

    </script>
</body>
</html>